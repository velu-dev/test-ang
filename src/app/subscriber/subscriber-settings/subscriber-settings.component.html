<div fxLayout="column" fxLayoutGap="25px">
    <div fxLayout="row wrap" class="d-cards">
        <div fxFlex="100" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" fxLayout="column">
            <mat-card class="shadow p-t-15">
                <mat-tab-group (selectedTabChange)="selectedTabChange($event)">
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <!-- <mat-icon class="example-tab-icon p-r-5"> security </mat-icon> -->
                            Security Settings
                        </ng-template>
                        <div class="edit-profile m-t-10">
                            <mat-card-content>
                                <form fxLayout="row wrap" (keydown.enter)="$event.target.tagName == 'TEXTAREA'"
                                    [formGroup]="userPasswrdForm" (ngSubmit)="changePassword()">
                                    <mat-form-field appearance="outline" fxFlex="100">
                                        <mat-label>Current Password*</mat-label>
                                        <input type="password" matInput placeholder="Current Password"
                                            autocomplete="off" formControlName="current_password">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidpassword}}</mat-error>
                                    </mat-form-field>
                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="50" fxFlex.lg="50"
                                        fxFlex.sm="50" fxFlex.xl="50">
                                        <mat-label>New Password*</mat-label>
                                        <input [type]="isTypePassword ? 'password': 'text'" matInput
                                            placeholder="New Password" autocomplete="off"
                                            formControlName="new_password">
                                        <mat-icon matSuffix
                                            matTooltip="Password must contain at least 8 characters, including UPPER, lowercase, special character and numbers."
                                            matTooltipPosition="above">error_outline</mat-icon>
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidpassword}}</mat-error>

                                    </mat-form-field>
                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="50" fxFlex.lg="50"
                                        fxFlex.sm="50" fxFlex.xl="50">
                                        <mat-label>Confirm New Password*</mat-label>
                                        <input [type]="isTypePassword ? 'password': 'text'" matInput
                                            placeholder="Confirm New Password" autocomplete="off"
                                            formControlName="confirmPassword">
                                        <mat-icon matSuffix (click)="changeInputType()">
                                            {{isTypePassword ? 'visibility' : 'visibility_off'}}</mat-icon>
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidpassword}}</mat-error>
                                    </mat-form-field>

                                    <div class="text-center w-100">
                                        <button mat-stroked-button (click)="cancel()" type="button"
                                            class="outline-danger">Cancel</button>
                                        <button mat-stroked-button class="m-l-10 outline-success">
                                            Save </button>
                                    </div>
                                </form>
                            </mat-card-content>
                        </div>
                    </mat-tab>


                    <mat-tab>
                        <ng-template mat-tab-label>
                            Account Settings
                        </ng-template>
                        <div class="edit-profile m-t-10" *ngIf="user?.role_id == 2">
                            <mat-card-content>
                                <form fxLayout="row wrap" (keydown.enter)="$event.target.tagName == 'TEXTAREA'"
                                    [formGroup]="userForm" (ngSubmit)="userformSubmit()">
                                    <div class="sub-title p-l-10" fxFlex="100">Account Number:
                                        {{user?.account_no | mask: '0000-0000-0000'}}
                                    </div>

                                    <mat-form-field appearance="outline" fxFlex="100" class="m-t-5">
                                        <mat-label>Company Name*</mat-label>
                                        <input matInput placeholder="Company Name" formControlName="company_name"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidcompanyname}}</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="30" fxFlex.lg="30"
                                        fxFlex.xl="30" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>First Name*</mat-label>
                                        <input matInput placeholder="First Name" formControlName="first_name"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidfirstname}}</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="30" fxFlex.lg="30"
                                        fxFlex.xl="30" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>Middle Name</mat-label>
                                        <input matInput placeholder="Middle Name" formControlName="middle_name"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidmiddlename}}</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="30" fxFlex.lg="30"
                                        fxFlex.xl="30" fxFlex.sm="50" fxFlex.xs="70">
                                        <mat-label>Last Name*</mat-label>
                                        <input matInput placeholder="Last Name" formControlName="last_name"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidlastname}}</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="10" fxFlex.lg="10"
                                        fxFlex.xl="10" fxFlex.sm="50" fxFlex.xs="30">
                                        <mat-label>Suffix</mat-label>
                                        <input matInput placeholder="Suffix" formControlName="suffix"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidsuffix}}</mat-error>
                                    </mat-form-field>
                                    <mat-form-field appearance="outline" fxFlex="100">
                                        <mat-label>Signin Email*</mat-label>
                                        <input matInput placeholder="Signin Email" formControlName="sign_in_email_id"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidemail}}</mat-error>
                                    </mat-form-field>
                                    <div class="sub-title p-l-10" fxFlex="100" fxFlex.md="100" fxFlex.sm="100"
                                        fxFlex.xs="100">Signature
                                        <br /> <small>
                                            Supported File Formats are JPEG/JPG/PNG with 4:1 Aspect Ratio &
                                            Maximum File Size: 500 KB
                                        </small>
                                    </div>
                                    <div fxFlex="100" fxFlex.lg="50" fxFlex.xl="50" fxFlex.md="50" fxFlex.sm="50"
                                        fxFlex.xs="100" class="sign-upload">
                                        <div fxLayout="row wrap">
                                            <mat-form-field appearance="standard"
                                                hideRequiredMarker="hideRequiredControl.auto"
                                                floatLabel="floatLabelControl.auto" fxFlex="80">
                                                <input matInput [title]="selectedFile" readonly
                                                    [value]="selectedFile | ellipsis:30" placeholder="No file chosen"
                                                    value="12345">
                                                <input type="file" #uploader accept=".png, .jpg, .jpeg" hidden
                                                    (change)="fileChangeEvent($event)" id="uploadFile">

                                            </mat-form-field>

                                            <button matSuffix type="button" (click)="uploader.click()"
                                                mat-stroked-button class="upload_btn outline-success p-t-2">Upload
                                            </button>

                                            <div fxFlex="100" *ngIf="!signData" class="m-t-20">
                                                <div class="empty-image m-l-10">
                                                    No image uploaded
                                                </div>
                                            </div>
                                            <div fxFlex="100" *ngIf="signData" class="m-t-20 sign-img">
                                                <button type="button" class="m-b-5" (click)="removeSign()"
                                                    mat-stroked-button>Remove </button><br />
                                                <div class="sign m-l-10">
                                                    <img [src]="signData">
                                                </div>

                                            </div>
                                        </div>
                                    </div>

                                    <div class="sub-title p-l-10 m-t-20" fxFlex="100" fxFlex.md="100" fxFlex.sm="100"
                                        fxFlex.xs="100">Payment Information
                                    </div>

                                    <mat-form-field appearance="outline" fxFlex="100" class="m-t-10">
                                        <mat-label>Accounting Name*</mat-label>
                                        <input matInput placeholder="Accounting Name" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="50" fxFlex.lg="50"
                                        fxFlex.xl="50" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>Accounting Email</mat-label>
                                        <input matInput placeholder="Accounting Email" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="50" fxFlex.lg="50"
                                        fxFlex.xl="50" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>Accounting Phone </mat-label>
                                        <input matInput placeholder="Accounting Phone" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="33.3" fxFlex.lg="33.3"
                                        fxFlex.xl="33.3" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>City*</mat-label>
                                        <input matInput placeholder="City" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="33.3" fxFlex.lg="33.3"
                                        fxFlex.xl="33.3" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>State*</mat-label>
                                        <input matInput placeholder="State" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="33.3" fxFlex.lg="33.3"
                                        fxFlex.xl="33.3" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>Zip Code*</mat-label>
                                        <input matInput placeholder="Zip Code" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <div class="sub-title p-l-10" fxFlex="100" fxFlex.md="100" fxFlex.sm="100"
                                        fxFlex.xs="100">Credit Card Information
                                    </div>
                                    <mat-form-field appearance="outline" fxFlex="100" class="m-t-10">
                                        <mat-label>Name on card*</mat-label>
                                        <input matInput placeholder="Name on card" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="33.3" fxFlex.lg="33.3"
                                        fxFlex.xl="33.3" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>Credit Card Number*</mat-label>
                                        <input matInput placeholder="Credit Card Number" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="33.3" fxFlex.lg="33.3"
                                        fxFlex.xl="33.3" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>Expiration Date*</mat-label>
                                        <input matInput placeholder="Expiration Date" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="33.3" fxFlex.lg="33.3"
                                        fxFlex.xl="33.3" fxFlex.sm="50" fxFlex.xs="100">
                                        <mat-label>CCV Code</mat-label>
                                        <input matInput placeholder="CCV Code" autocomplete="off">
                                        <mat-error>error msg here..</mat-error>
                                    </mat-form-field>

                                    <div class="text-center w-100 m-t-10 m-b-10">
                                        <button (click)="cancel()" mat-stroked-button type="button"
                                            class="outline-danger">Cancel</button>
                                        <button mat-stroked-button class="m-l-10 outline-success">Save </button>
                                    </div>
                                </form>
                            </mat-card-content>
                        </div>
                        <div class="edit-profile m-t-10" *ngIf="user?.role_id != 2">
                            <mat-card-content>
                                <form fxLayout="row wrap" (keydown.enter)="$event.target.tagName == 'TEXTAREA'"
                                    [formGroup]="userForm" (ngSubmit)="userformSubmit()">

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="30" fxFlex.lg="30"
                                        fxFlex.xl="30" fxFlex.sm="50" fxFlex.xs="100" class="">
                                        <mat-label>First Name*</mat-label>
                                        <input matInput placeholder="First Name" formControlName="first_name"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidfirstname}}</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="30" fxFlex.lg="30"
                                        fxFlex.xl="30" fxFlex.sm="50" fxFlex.xs="100" class=" ">
                                        <mat-label>Middle Name</mat-label>
                                        <input matInput placeholder="Middle Name" formControlName="middle_name"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidmiddlename}}</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="30" fxFlex.lg="30"
                                        fxFlex.xl="30" fxFlex.sm="80" fxFlex.xs="80" class=" ">
                                        <mat-label>Last Name*</mat-label>
                                        <input matInput placeholder="Last Name" formControlName="last_name"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidlastname}}</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="10" fxFlex.lg="10"
                                        fxFlex.xl="10" fxFlex.sm="20" fxFlex.xs="20" class="">
                                        <mat-label>Suffix</mat-label>
                                        <input matInput placeholder="Suffix" formControlName="suffix"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidsuffix}}</mat-error>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" fxFlex="100" fxFlex.md="100" fxFlex.lg="100"
                                        fxFlex.xl="100" fxFlex.sm="100" class="p-r-10">
                                        <mat-label>Signin Email*</mat-label>
                                        <input matInput placeholder="Signin Email" formControlName="sign_in_email_id"
                                            autocomplete="off">
                                        <mat-error *ngIf="isSubmit">{{errorMessages?.entervalidemail}}</mat-error>
                                    </mat-form-field>

                                    <div class="sub-title p-l-10" fxFlex="100" fxFlex.md="100" fxFlex.sm="100"
                                        fxFlex.xs="100">Signature

                                        <br /><small>
                                            Supported File Formats are JPEG/JPG/PNG with 4:1 Aspect Ratio &
                                            Maximum File Size: 500 KB
                                        </small>
                                    </div>
                                    <div fxFlex="100" fxFlex.lg="50" fxFlex.xl="50" fxFlex.md="50" fxFlex.sm="50"
                                        fxFlex.xs="100" class="sign-upload">
                                        <div fxLayout="row wrap">
                                            <mat-form-field appearance="standard"
                                                hideRequiredMarker="hideRequiredControl.auto"
                                                floatLabel="floatLabelControl.auto" fxFlex="80" class="w-100">
                                                <input matInput [title]="selectedFile" readonly
                                                    [value]="selectedFile | ellipsis:30" placeholder="No file chosen"
                                                    value="12345">
                                                <input type="file" #uploader accept=".png, .jpg, .jpeg" hidden
                                                    (change)="fileChangeEvent($event)" id="uploadFile">

                                            </mat-form-field>
                                            <button matSuffix type="button" (click)="uploader.click()"
                                                mat-stroked-button class="upload_btn outline-success">Upload
                                                <!-- <span class="fa fa-upload"></span> -->
                                            </button>

                                            <div fxFlex="100" *ngIf="!signData" class="m-t-20">
                                                <div class="empty-image m-l-10">
                                                    No image uploaded
                                                </div>
                                            </div>
                                            <div fxFlex="100" *ngIf="signData" class="m-t-20 sign-img">
                                                <button type="button" class="m-b-5" (click)="removeSign()"
                                                    mat-stroked-button>Remove </button><br />
                                                <div class="sign m-l-10">
                                                    <img [src]="signData">
                                                </div>

                                            </div>
                                        </div>
                                    </div>

                                    <div class="text-center w-100 m-t-10 m-b-10">
                                        <button mat-stroked-button type="button" class="outline-danger"
                                            (click)="cancel()">Cancel</button>
                                        <button mat-stroked-button class="m-l-10 outline-success">Save </button>
                                    </div>
                                </form>
                            </mat-card-content>
                        </div>
                    </mat-tab>

                    <mat-tab *ngIf="user?.role_id == 2">
                        <ng-template mat-tab-label>
                            Invoice History
                        </ng-template>
                        <div class="edit-profile m-t-10">
                            <mat-card-content>
                                <div class="user-detail">
                                    <table mat-table [dataSource]="dataSource" multiTemplateDataRows
                                        class="mat-elevation-z8 user-table" matSort>
                                        <ng-container matColumnDef="{{column}}"
                                            *ngFor="let column of columnsToDisplay; let i=index">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header
                                                [disabled]="columnName[i] == 'Action'">
                                                {{columnName[i]}} </th>
                                            <td mat-cell *matCellDef="let element">
                                                <span *ngIf="i == 0 && isMobile">
                                                    <mat-icon mat-raised-button
                                                        [ngClass]="{'table-expand': expandId == element.id, 'expand-close': !(expandId == element.id)}">
                                                        {{ expandId == element.id ? 'remove_circle' : 'add_circle'}}
                                                    </mat-icon>
                                                </span>
                                                <div>
                                                    <span *ngIf="column == 'invoice_number'">
                                                        {{element?.invoice_number}}
                                                    </span>
                                                    <span *ngIf="column == 'amount'">{{element?.amount}}</span>
                                                    <span *ngIf="column == 'status'">{{element?.status}}</span>
                                                    <span *ngIf="column == 'date'">{{element?.date}}</span>
                                                    <span *ngIf="column == 'action'"><a
                                                            class="text-success">{{element?.action}}</a></span>
                                                </div>
                                            </td>
                                        </ng-container>
                                        <ng-container matColumnDef="expandedDetail">
                                            <td mat-cell *matCellDef="let element"
                                                [attr.colspan]="columnsToDisplay.length">
                                                <div class="detail"
                                                    [@detailExpand]="expandId === element.id ? 'expanded' : 'collapsed'">
                                                    <div class="resposive-table">
                                                        <div><span>Invoice Number</span> {{element?.invoice_number}}
                                                        </div>
                                                        <div><span>Amount</span> {{element?.amount}} </div>
                                                        <div><span>Status</span> {{element?.status}} </div>
                                                        <div><span>Date</span> {{element?.date}} </div>
                                                        <div><span>Action</span><a class="text-success">
                                                                {{element?.action}} </a></div>
                                                    </div>
                                                </div>
                                            </td>
                                        </ng-container>
                                        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
                                        <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" class="row"
                                            [class.row]="expandedElement === element" (click)="openElement(element)">
                                        </tr>
                                        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']"
                                            class="detail-row"></tr>
                                    </table>
                                    <app-nodata *ngIf="dataSource?.filteredData?.length == 0"></app-nodata>
                                </div>

                                <mat-paginator [pageSizeOptions]="[10, 25, 100]"></mat-paginator>
                            </mat-card-content>
                        </div>
                    </mat-tab>
                </mat-tab-group>
            </mat-card>
        </div>
    </div>
</div>