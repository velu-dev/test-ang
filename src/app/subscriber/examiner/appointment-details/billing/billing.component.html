<div class="billing">
    <!-- ===== Bill Status ==== -->
    <div fxLayout="row wrap" class="p-t-20">
        <div fxFlex="100" fxFlex.sm="100" fxFlex.xs="100" class="bill-status">
            <div class="progress">
                <div class="main-title p-l-0">Bill Status</div>
                <p class="description p-l-0">View the Billâ€™s progress here, from beginning to end.</p>
                <mat-progress-bar mode="determinate" value="50" class="not-sent p-l-0 m-b-20">
                </mat-progress-bar>
            </div>
            <div class="review-status">
                <div>First Bill Review</div>
            </div>
            <!-- <div class="text-center">Not Sent</div> -->
        </div>
        <!-- <div fxFlex="20" fxFlex.sm="100" fxFlex.xs="100" class="review-status">
            <div>First Bill Review</div>
        </div> -->
    </div>
    <div fxLayout="row wrap" class="p-t-20">
        <div fxFlex="50">
            <div class="bill-id"><span>Bill : </span> {{billingData?.agent_short_code}}{{billingData?.bill_no}}</div>
        </div>
        <div fxFlex="50">
            <div class="submission-date"><span>First Bill Review Submission Date:</span>-</div>
        </div>
    </div>

    <div class="border-dashed-blue"></div>

    <!-- ===== Examiner information ==== -->
    <!-- <div class="examiner-info">
        <mat-card>
            <mat-card-header>
                <div class="content-wrapper-main-title p-t-5">Payer Information</div>
            </mat-card-header>
            <mat-divider></mat-divider>
            <mat-card-content>
                <div fxLayout="row wrap" class="p-t-20">
                    <div fxFlex="50" fxFlex.sm="100" fxFlex.xs="100">
                        <div fxLayout="row wrap">
                            <div fxFlex="15" fxFlex.sm="100" fxFlex.xs="100" class="p-t-20">Payer ID</div>
                            <mat-form-field appearance="outline" fxFlex="85" fxFlex.sm="100" fxFlex.xs="100">

                                <input matInput [formControl]="payorCtrl">
                            
                            </mat-form-field>
                        </div>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div> -->

    <!-- ===== incomplete information ==== -->
    <div class="incomplete-info" *ngIf="!isIncompleteError">
        <mat-card>
            <mat-card-header>
                <div class="content-wrapper-main-title text-danger">Incomplete Information</div>
            </mat-card-header>
            <mat-divider class="border-red"></mat-divider>
            <mat-card-content>
                <div fxLayout="row wrap" class="p-t-10">
                    <div class="incomplete-modules" fxFlex="100">
                        <ul>
                            <li *ngFor="let incompleteInfo of incompleteInformation">
                                <mat-icon>error</mat-icon> {{incompleteInfo}}
                            </li>
                        </ul>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>

    <div class="incomplete-info" *ngIf="payerResponse.length">
        <mat-card>
            <mat-card-header>
                <div class="content-wrapper-main-title text-danger">Claims Administrator Feedback</div>
            </mat-card-header>
            <mat-divider class="border-red"></mat-divider>
            <mat-card-content>
                <div fxLayout="row wrap" class="p-t-10">
                    <div class="incomplete-modules" fxFlex="100">
                        <ul>
                            <li *ngFor="let payer of payerResponse"><mat-icon>error</mat-icon>{{payer?.status_date | date:'MM-dd-yyyy' }} - {{payer?.MessageText}}</li>
                        </ul>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>

    <!-- ===== Examiner information ==== -->
    <div class="examiner-info">
        <mat-card>
            <mat-card-header>
                <div class="content-wrapper-main-title">Provider Information</div>
            </mat-card-header>
            <mat-divider></mat-divider>
            <mat-card-content>
                <div fxLayout="row wrap" class="p-t-20">
                    <div fxFlex="33.3" fxFlex.xs="100">
                        <div class="p-b-5"><b>Billing Provider</b></div>
                        <div *ngIf="billingData?.billing_is_person"> {{billingData?.billing_last_name}}
                            {{billingData?.billing_first_name}}{{billingData?.billing_suffix ? (', '+ billingData?.billing_suffix) : ''}}
                        </div>
                        <div *ngIf="!billingData?.billing_is_person">{{billingData?.billing_provider_name}}</div>
                    </div>
                    <div fxFlex="33.3" fxFlex.xs="100">
                        <div class="p-b-5"><b>Rendering Provider</b></div>
                        <div *ngIf="billingData?.rendering_is_persion">{{billingData?.rendr_last_name}}
                            {{billingData?.rendr_first_name}}{{billingData?.rendr_suffix ? (', '+ billingData?.rendr_suffix) : ''}}
                        </div>
                        <div *ngIf="!billingData?.rendering_is_persion">{{billingData?.rendering_provider_name}}</div>
                    </div>
                    <div fxFlex="33.3" fxFlex.xs="100">
                        <div class="p-b-5"><b>Service Location</b> </div>
                        <div>{{billingData?.service_location?.street1 }} {{billingData?.service_location?.street2 }}
                            {{billingData?.service_location?.city}}
                            {{billingData?.state_code }}
                            {{billingData?.service_location?.zip_code ? '- ' + billingData?.service_location?.zip_code : '' }}
                        </div>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>

    <!-- ===== Diagnosis Codes ==== -->
    <div class="diagnosis-info">
        <mat-card>
            <mat-card-header>
                <div class="content-wrapper-main-title">Diagnosis Codes<span class="info ondemand-info m-l-10"
                        matTooltip="Maximum 12 Diagnosis Codes will be allowed here!" matTooltipPosition="above"> <i
                            class="fa fa-info" aria-hidden="true"></i></span></div>
            </mat-card-header>
            <mat-divider></mat-divider>
            <mat-card-content>
                <div fxLayout="row wrap" class="m-t-10">
                    <div class="table-filter m-b-10">
                        <input [formControl]="icdCtrl" [matAutocomplete]="auto" placeholder="Search by code or name">
                        <mat-autocomplete #auto="matAutocomplete">
                            <mat-option (click)="selectICD(icd)" [title]="icd[1]" *ngFor="let icd of filteredICD"
                                [value]="icd[1]">
                                {{icd[0] + " "+ icd[1]}}
                            </mat-option>
                            <mat-option disabled *ngIf="filteredICD?.length == 0">
                                Not Found
                            </mat-option>
                        </mat-autocomplete>
                        <mat-icon>search</mat-icon>
                    </div>
                    <span class="spacer"></span>
                    <!-- <button mat-raised-button (click)="addIcd()" class="filled-gray">
                        Add
                    </button> -->
                </div>
                <div fxLayout="row wrap">
                    <div class="user-detail vertical-fixed default-cursor">
                        <table mat-table [dataSource]="IcdDataSource" multiTemplateDataRows
                            class="mat-elevation-z8 user-table" matSort>
                            <ng-container matColumnDef="{{column}}"
                                *ngFor="let column of columnsToDisplay; let i=index">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header
                                    [disabled]="columnName[i] == 'Action'">
                                    {{columnName[i]}} </th>
                                <td mat-cell *matCellDef="let element; let i=index">
                                    <span *ngIf="i == 0 && isMobile">
                                        <mat-icon mat-raised-button
                                            [ngClass]="{'table-expand': icdExpandID == element.code, 'expand-close': !(icdExpandID == element.code)}">
                                            {{ icdExpandID == element.code ? 'remove_circle' : 'add_circle'}}
                                        </mat-icon>
                                    </span>
                                    <div>
                                        <span *ngIf="column == 'code'">{{element?.code}}</span>
                                        <span *ngIf="column == 'name'">{{element?.name}}</span>
                                        <span *ngIf="column == 'action'">
                                            <a class="text-danger" (click)="removeICD(element)">Remove</a>
                                        </span>
                                    </div>
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="expandedDetail">
                                <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                                    <div class="detail"
                                        [@detailExpand]="icdExpandID == element.code ? 'expanded' : 'collapsed'">
                                        <div class="responsive-table">
                                            <div><span>Code</span><span> {{element?.code}} </span></div>
                                            <div><span>Name</span><span> {{element?.name}} </span></div>

                                        </div>
                                    </div>
                                </td>
                            </ng-container>
                            <tr mat-header-row *matHeaderRowDef="columnsToDisplay;sticky :true"></tr>
                            <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" class="row"
                                [class.row]="expandedElement === element" (click)="openElement(element)">
                            </tr>
                            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
                        </table>
                        <app-nodata *ngIf="IcdDataSource?.filteredData?.length == 0"></app-nodata>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
    <!-- ===== Bill Items ==== -->
    <div class="bill-item">
        <mat-card>
            <mat-card-header>
                <div class="content-wrapper-main-title">Billing Line Items</div>
                <span class="spacer"></span>
                <button mat-raised-button class="filled-gray m-b-5" (click)="addRow()">
                    Add Billing Line Item
                </button>
            </mat-card-header>
            <mat-divider></mat-divider>
            <mat-card-content class="m-b-10">
                <div fxLayout="row wrap" class="m-t-10">
                    <div #scrollBottom class="user-detail vertical-fixed hide-mobile">

                        <form [formGroup]="userTable">
                            <table class="table table-border res-table" [ngClass]="{'table-dark': mode}">
                                <thead class="text-nowrap">
                                    <th>Item </th>
                                    <th>Procedure Code</th>
                                    <th>Modifier</th>
                                    <th>Unit Type</th>
                                    <th>Units</th>
                                    <th>Charge</th>
                                    <th>Payment</th>
                                    <th>Balance</th>
                                    <th>Action</th>
                                </thead>
                                <tbody>
                                    <ng-container formArrayName="tableRows"
                                        *ngFor="let group of getFormControls.controls ; let i=index">
                                        <tr *ngIf="group.get('isEditable').value" [formGroupName]="i"
                                            (click)="rowSelected(group)">
                                            <td>
                                                <mat-form-field appearance="outline" *ngIf="i != 0">
                                                    <input matInput type="text" [disabled]="" autocomplete="off"
                                                        formControlName="item_description">
                                                </mat-form-field>
                                                <span *ngIf="i == 0">
                                                    {{group.get('item_description').value}}
                                                </span>
                                            </td>
                                            <td>
                                                <mat-form-field appearance="outline">
                                                    <input matInput type="text" autocomplete="off"
                                                        formControlName="procedure_code">
                                                </mat-form-field>
                                            </td>
                                            <td class="bill-modifier">

                                                <mat-form-field class="chip-list">
                                                    <mat-chip-list #chipList aria-label="Modifier selection"
                                                        formControlName="modifierList">
                                                        <mat-chip *ngFor="let modifier of group.value.modifierList"
                                                            [removable]="removable" (removed)="remove(modifier,group)">
                                                            {{modifier}}
                                                            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                                                        </mat-chip>
                                                        <input #modifierInput formControlName="modifier"
                                                            [matAutocomplete]="auto1" [matChipInputFor]="chipList"
                                                            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                                            [matChipInputAddOnBlur]="addOnBlur"
                                                            #trigger="matAutocompleteTrigger"
                                                            (matChipInputTokenEnd)="add($event,group)"
                                                            (click)="openAuto($event,trigger)">
                                                    </mat-chip-list>
                                                    <mat-autocomplete #auto1="matAutocomplete"
                                                        (optionSelected)="selected($event,group)">
                                                        <mat-option *ngFor="let modifier of filteredmodifier"
                                                            [value]="modifier">
                                                            {{modifier}}
                                                        </mat-option>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field appearance="outline" class="w-100">
                                                    <mat-select formControlName="unitType">
                                                        <mat-option *ngFor="let unit of unitTypes"
                                                            [value]="unit.unit_type">
                                                            {{unit.unit_type}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field appearance="outline" class="w-100">
                                                    <input matInput min="0" type="number" autocomplete="off"
                                                        formControlName="units">
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field appearance="outline" class="w-100">
                                                    <input matInput min="0" type="number" autocomplete="off"
                                                        formControlName="charge" (change)="setTwoNumberDecimal($event)">
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                {{group.value.payment | number : '1.2-2'}}
                                            </td>
                                            <td>
                                                <span class="text-danger">
                                                    {{group.value.charge - group.value.payment | number : '1.2-2'}}</span>
                                            </td>

                                            <td class="no-wrap-td">
                                                <a class="text-success" (click)="doneRow(group,i)">
                                                    Save
                                                </a>
                                                <a class="text-danger m-l-10" (click)="cancelRow(group,i)">
                                                    Cancel
                                                </a>
                                            </td>
                                        </tr>
                                        <tr *ngIf="!group.get('isEditable').value" class="bill-value">
                                            <td>
                                                {{group.get('item_description').value}}
                                            </td>
                                            <td>
                                                {{group.get('procedure_code').value}}
                                            </td>
                                            <td>
                                                {{group.get('modifierList').value}}
                                            </td>
                                            <td>
                                                {{group.get('unitType').value}}
                                            </td>
                                            <td>
                                                {{group.get('units').value}}
                                            </td>
                                            <td>
                                                {{group.get('charge').value | number : '1.2-2'}}
                                            </td>
                                            <td>
                                                {{group.get('payment').value | number : '1.2-2'}}
                                            </td>
                                            <td>
                                                {{(group.get('charge').value) | number : '1.2-2'}}
                                            </td>
                                            <td class="no-wrap-td">

                                                <a class="text-success"
                                                    (click)="group.get('is_post_payment').value ? openDialog(true,group) : editRow(group)">
                                                    Edit
                                                </a>

                                                <a *ngIf="i != 0" class="text-danger m-l-10"
                                                    (click)="deleteRow(i,group)">
                                                    Remove
                                                </a>
                                            </td>
                                        </tr>

                                    </ng-container>

                                </tbody>
                                <tfoot *ngIf="getFormControls.controls.length > 0">
                                    <tr class="bill-value" id="static-footer">
                                        <td>Total </td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td>{{calculateTotal() | number : '1.2-2'}}</td>
                                        <td>{{calculateTotalPayment() | number : '1.2-2' }}</td>
                                        <td><span class="text-danger">{{calculateTotalBal() | number : '1.2-2'}}</span>
                                        </td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </form>
                    </div>
                </div>
            </mat-card-content>




            <div class="bill-line-mobile show-mobile">
                <form [formGroup]="userTable">
                    <table>
                        <tbody>
                            <ng-container formArrayName="tableRows"
                                *ngFor="let group of getFormControls.controls ; let i=index">
                                <tr *ngIf="group.get('isEditable').value" [formGroupName]="i"
                                    (click)="rowSelected(group)" class="editable-bill">
                                    <td>
                                        <mat-card>
                                            <div class="flex">
                                                <div class="bill-property">Item</div>
                                                <div class="editable">
                                                    <mat-form-field appearance="outline" *ngIf="i != 0">
                                                        <input matInput type="text" [disabled]="" autocomplete="off"
                                                            formControlName="item_description">
                                                    </mat-form-field>
                                                    <span *ngIf="i == 0">
                                                        {{group.get('item_description').value}}
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="flex">
                                                <div class="bill-property">Procedure Code</div>
                                                <div class="editable">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" autocomplete="off"
                                                            formControlName="procedure_code">
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                            <div class="flex">
                                                <div class="bill-property">Modifier</div>
                                                <div class="editable">
                                                    <mat-form-field class="chip-list">
                                                        <mat-chip-list #chipList aria-label="Modifier selection"
                                                            formControlName="modifierList">
                                                            <mat-chip *ngFor="let modifier of group.value.modifierList"
                                                                [removable]="removable"
                                                                (removed)="remove(modifier,group)">
                                                                {{modifier}}
                                                                <mat-icon matChipRemove *ngIf="removable">cancel
                                                                </mat-icon>
                                                            </mat-chip>
                                                            <input #modifierInput formControlName="modifier"
                                                                [matAutocomplete]="auto1" [matChipInputFor]="chipList"
                                                                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                                                [matChipInputAddOnBlur]="addOnBlur"
                                                                #trigger="matAutocompleteTrigger"
                                                                (matChipInputTokenEnd)="add($event,group)"
                                                                (click)="openAuto($event,trigger)">
                                                        </mat-chip-list>
                                                        <mat-autocomplete #auto1="matAutocomplete"
                                                            (optionSelected)="selected($event,group)">
                                                            <mat-option *ngFor="let modifier of filteredmodifier"
                                                                [value]="modifier">
                                                                {{modifier}}
                                                            </mat-option>
                                                        </mat-autocomplete>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                            <div class="flex">
                                                <div class="bill-property">Unit Type</div>
                                                <div class="editable">
                                                    <mat-form-field appearance="outline" class="w-100">
                                                        <mat-select formControlName="unitType">
                                                            <mat-option *ngFor="let unit of unitTypes"
                                                                [value]="unit.unit_type">
                                                                {{unit.unit_type}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                            <div class="flex">
                                                <div class="bill-property">Units</div>
                                                <div class="editable">
                                                    <mat-form-field appearance="outline" class="w-100">
                                                        <input matInput type="number" autocomplete="off"
                                                            formControlName="units">
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                            <div class="flex">
                                                <div class="bill-property">Charge</div>
                                                <div class="editable">
                                                    <mat-form-field appearance="outline" class="w-100">
                                                        <input matInput type="number" autocomplete="off"
                                                            formControlName="charge"
                                                            (change)="setTwoNumberDecimal($event)">
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                            <div class="flex">
                                                <div class="bill-property">Payment</div>
                                                <div class="editable"> {{group.value.payment | number : '1.2-2'}}</div>
                                            </div>
                                            <div class="flex">
                                                <div class="bill-property">Balance</div>
                                                <div class="editable">
                                                    {{(group.get('charge').value) | number : '1.2-2'}}</div>
                                            </div>
                                            <div class="flex">
                                                <div class="bill-property">Action </div>
                                                <div class="editable">
                                                    <a class="text-success" (click)="doneRow(group,i)">
                                                        Save
                                                    </a>
                                                    <a class="text-danger m-l-10" (click)="cancelRow(group,i)">
                                                        Cancel
                                                    </a>
                                                </div>
                                            </div>
                                        </mat-card>
                                    </td>
                                </tr>
                                <tr>
                                    <td *ngIf="!group.get('isEditable').value">

                                        <mat-accordion>
                                            <mat-expansion-panel>
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        <mat-icon class="expand-close p-t-0">add_circle</mat-icon>
                                                        <b>Item :</b> {{group.get('item_description').value}}
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>
                                                <mat-card>
                                                    <div class="flex">
                                                        <div class="bill-property">Item</div>
                                                        <div class="value">{{group.get('item_description').value}}
                                                        </div>
                                                    </div>
                                                    <div class="flex">
                                                        <div class="bill-property">Procedure Code</div>
                                                        <div class="value">{{group.get('procedure_code').value}}</div>
                                                    </div>
                                                    <div class="flex">
                                                        <div class="bill-property">Modifier</div>
                                                        <div class="value"> {{group.get('modifierList').value}}</div>
                                                    </div>
                                                    <div class="flex">
                                                        <div class="bill-property">Unit Type</div>
                                                        <div class="value"> {{group.get('unitType').value}}</div>
                                                    </div>
                                                    <div class="flex">
                                                        <div class="bill-property">Units</div>
                                                        <div class="value">{{group.get('units').value}}</div>
                                                    </div>
                                                    <div class="flex">
                                                        <div class="bill-property">Charge</div>
                                                        <div class="value">
                                                            {{group.get('charge').value | number : '1.2-2'}}</div>
                                                    </div>
                                                    <div class="flex">
                                                        <div class="bill-property">Payment</div>
                                                        <div class="value">
                                                            {{group.get('payment').value | number : '1.2-2'}}</div>
                                                    </div>
                                                    <div class="flex">
                                                        <div class="bill-property">Balance</div>
                                                        <div class="value">
                                                            {{(group.get('charge').value) | number : '1.2-2'}}</div>
                                                    </div>
                                                    <div class="flex">
                                                        <div class="bill-property">Action </div>
                                                        <div class="value"> <a class="text-success"
                                                                (click)="group.get('is_post_payment').value ? openDialog(true,group) : editRow(group)">
                                                                Edit
                                                            </a>

                                                            <a *ngIf="i != 0" class="text-danger m-l-10"
                                                                (click)="deleteRow(i,group)">
                                                                Remove
                                                            </a></div>
                                                    </div>
                                                </mat-card>

                                            </mat-expansion-panel>
                                        </mat-accordion>

                                    </td>
                                </tr>
                            </ng-container>
                        </tbody>
                        <tfoot *ngIf="getFormControls.controls.length > 0">
                            <tr class="bill-value" id="static-footer">
                                <td>
                                    <mat-card>
                                        <div class="grid-list">
                                            <div><b>Total Charge </b></div>
                                            <div>{{calculateTotal() | number : '1.2-2'}}</div>
                                        </div>

                                        <div class="grid-list">
                                            <div><b>Total Payment</b></div>
                                            <div>{{calculateTotalPayment() | number : '1.2-2' }}</div>
                                        </div>

                                        <div class="grid-list">
                                            <div><b>Total Balance: </b></div>
                                            <div class="text-danger">
                                                {{calculateTotalBal() | number : '1.2-2'}} </div>
                                        </div>
                                    </mat-card>
                                </td>

                            </tr>
                        </tfoot>
                    </table>
                </form>
            </div>





        </mat-card>
    </div>

    <!-- ===== Examination Submission Documents ==== -->
    <div fxlayout="row wrap" class="m-t-30 submission-document">
        <mat-card>
            <mat-card-header fxLayout="row wrap">
                <div class="content-wrapper-main-title" fxFlex="50">{{billDocumentList?.exam_procedure_name}}
                    Examination Submission Documents
                    <span class="info ondemand-info m-l-10"
                        matTooltip="The QME 122 - Declaration of service form will be created when the Report Documents are Downloaded or Billed on Demand."
                        matTooltipPosition="above"> <i class="fa fa-info" aria-hidden="true"></i></span></div>
                <div class="content-wrapper-main-title bill-status" fxFlex="50">Original Submission</div>
            </mat-card-header>
            <mat-divider></mat-divider>
            <mat-card-content>
                <div fxLayout="row wrap">
                    <div fxFlex="100">See <span>these directions</span> provided by the state of California.</div>
                    <!-- <div fxFlex="100">Please download, finalize and upload the following
                        documents:</div> -->
                    <div fxFlex="100">Complete the following documents by downloading them, filling them and uploading
                        them below:
                    </div>
                    <div>
                        <ul *ngFor="let doc of this.billDocumentList?.document_info">
                            <li> {{doc}}</li>
                        </ul>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
    <!-- ===== Documents ==== -->
    <div class="documents">
        <mat-card>
            <mat-card-header>
            </mat-card-header>
            <mat-card-content>
                <!-- <div class="w-100">
                    <div fxLayout="row wrap" fxFlex="100" class="document-file-upload w-100">
                        <div fxFlex="100" fxFlex.sm="100" fxFlex.md="50" fxFlex.lg="50" fxFlex.xl="50" class="Upload_">
                            <button type="button" mat-stroked-button class="filled-gray"
                                (click)="uploader.click()">Select File
                            </button>
                            <mat-form-field appearance="standard">
                                <input matInput [(ngModel)]="file" readonly placeholder="No file chosen">
                                <input type="file" #uploader hidden (change)="addFile($event)" hidden
                                    accept=".pdf, .doc, .docx, .xls, .xlsx, .csv" required>
                                <mat-hint>Supported file formats: .pdf, .doc, .docx, .excel, .csv</mat-hint>
                                <mat-hint *ngIf="errors.file.isError">
                                    <mat-error>{{errors.file.error}}</mat-error>
                                </mat-hint>
                            </mat-form-field>
                        </div>
                        <div fxFlex="100" fxFlex.sm="100" fxFlex.md="20" fxFlex.lg="20" fxFlex.xl="20">
                            <button mat-stroked-button type="button" class="filled-gray add-btn p-r-20 m-t-20"
                                (click)="uploadFile()">Add
                            </button>
                        </div>
                    </div>
                </div> -->
                <div fxLayout="row wrap" class="w-100 m-t-15">
                    <div fxFlex="70" fxFlex.sm="100" fxFlex.xs="100" class="note">
                        <mat-icon>info</mat-icon> Note : Supported file formats: .pdf, .doc, .docx
                    </div>
                    <div fxFlex="30" fxFlex.sm="100" fxFlex.xs="100">
                        <input type="file" #uploader hidden (change)="addFile($event,true)" multiple
                            accept=".pdf, .doc, .docx" required>
                        <button mat-raised-button class="float-right filled-gray m-r-5 m-b-5"
                            (click)="uploader.click()"><i class="fa fa-file-medical p-r-10"></i> Add Custom
                            Document</button>
                    </div>
                    <div class="user-detail vertical-fixed default-cursor" fxFlex="100">
                        <table mat-table [dataSource]="documentsData" multiTemplateDataRows
                            class="mat-elevation-z8 user-table">
                            <ng-container matColumnDef="{{column}}"
                                *ngFor="let column of columnsToDisplay2; let i=index">
                                <th mat-header-cell *matHeaderCellDef>
                                    {{columnName2[i]}} </th>
                                <td mat-cell *matCellDef="let element;let j">
                                    <span *ngIf="i == 0 && isMobile">
                                        <mat-icon mat-raised-button
                                            [ngClass]="{'table-expand': expandId2 == j, 'expand-close': !(expandId2 == j)}">
                                            {{ expandId2 == j ? 'remove_circle' : 'add_circle'}}
                                        </mat-icon>
                                    </span>
                                    <div> <span *ngIf="column == 'doc_image'" class="file_type_icon">
                                         <!-- <img [src]="element?.file_name | fileType" alt=""> -->
                                        </span>
                                        <span *ngIf="column == 'file_name'">{{element?.form_name}}</span>
                                        <span *ngIf="column == 'partial'">

                                            <a class="text-ternary m-r-10" (click)="download(element?.partial_document)"
                                                *ngIf="element?.partial_document">{{element?.partial_document?.file_name}}
                                                <i class="fas fa-download"></i></a>
                                        </span>
                                        <span *ngIf="column == 'complete'">
                                            <a class="text-ternary m-r-10"
                                                (click)="download(element?.completed_document)"
                                                *ngIf="element?.completed_document">{{element?.completed_document?.file_name}}
                                                <i class="fas fa-download"></i></a>

                                            <a *ngIf="!element?.completed_document && element?.form_action_type != 'C'"
                                                class="m-r-10 no-wrap-td" (click)="uploader.click()">
                                                Upload Completed Form
                                                <i class="fa fa-upload m-b-3"></i>
                                            </a>
                                            <input type="file" #uploader hidden
                                                (change)="addCompleteDoc($event,element?.partial_document?.id)" hidden
                                                accept=".pdf, .doc, .docx" required>
                                        </span>
                                        <span
                                            *ngIf="column == 'document_type'">{{element?.document_type | titlecase}}</span>
                                        <span
                                            *ngIf="column == 'updatedAt'">{{element?.updatedAt | date:'MM-dd-yyyy hh:mm a'}}</span>
                                        <span *ngIf="column == 'action'">
                                            <!-- <a class="text-success m-r-10" (click)="download(element)">Download</a> -->
                                            <input type="file" #uploader hidden
                                                (change)="addCompleteDoc($event,element?.partial_document?.id)" hidden
                                                accept=".pdf" required>
                                            <a *ngIf="element?.form_action_type != 'C'" class="text-danger no-wrap-td"
                                                (click)=" element?.completed_document ? uploader.click() : ''">Remove
                                                and Reupload
                                            </a>
                                            <a *ngIf="element?.form_name == 'Custom'" class="text-danger no-wrap-td"
                                                (click)="deleteDocument(element?.completed_document,true)">Remove
                                            </a>
                                        </span>
                                    </div>
                                </td>
                                <!-- <td mat-footer-cell *matFooterCellDef colspan="3"> Test </td> -->
                            </ng-container>
                            <!-- <ng-container matColumnDef="custom_doc">
                                <td mat-footer-cell *matFooterCellDef colspan="5" class="text-center bg-light">
                                    <b class="add-custom"><i class="fa fa-file-medical p-r-10"></i> Add Custom Document</b>
                                </td>
                            </ng-container>  -->
                            <ng-container matColumnDef="expandedDetail">
                                <td mat-cell *matCellDef="let element;let k = index"
                                    [attr.colspan]="columnsToDisplay2.length">
                                    <div class="detail" [@detailExpand]="expandId2 == k ? 'expanded' : 'collapsed'">
                                        <div class="responsive-table">
                                            <div><span>File Name</span><span> {{element?.file_name}} </span></div>
                                            <div><span>Download Partial Document</span><span> <a
                                                        class="text-ternary m-r-10"
                                                        (click)="download(element?.partial_document)"
                                                        *ngIf="element?.partial_document">{{element?.partial_document?.file_name}}
                                                        <i class="fas fa-download"></i></a></span>
                                            </div>
                                            <div><span>Complete</span><span> <a class="text-ternary m-r-10"
                                                        (click)="uploader.click()">Upload Completed
                                                        Form <i class="fa fa-upload m-b-3"></i></a>
                                                    <input type="file" #uploader hidden (change)="addFile($event)"
                                                        hidden accept=".pdf, .doc, .docx, .xls, .xlsx, .csv" required>
                                                </span>
                                            </div>
                                            <div><span>Action</span><span><a class="text-danger"
                                                        *ngIf="element?.form_name != 'Custom'"
                                                        (click)="deleteDocument(element)">Remove and Reupload
                                                    </a>
                                                    <a class="text-danger" *ngIf="element?.form_name == 'Custom'"
                                                        (click)="deleteDocument(element)">Remove </a></span></div>
                                            <!-- <div><span>Date</span><span> {{element?.date}} </span></div> -->

                                        </div>
                                    </div>
                                </td>
                                <!-- <td mat-footer-cell *matFooterCellDef> Test </td> -->
                            </ng-container>
                            <tr mat-header-row *matHeaderRowDef="columnsToDisplay2;sticky :true"></tr>
                            <tr mat-row *matRowDef="let element;let i = index; columns: columnsToDisplay2;" class="row"
                                [class.row]="expandedElement === element" (click)="openElementBill(i)">
                            </tr>
                            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
                            <!-- <tr mat-footer-row *matFooterRowDef="['custom_doc']; sticky: true"></tr> -->
                        </table>
                        <app-nodata *ngIf="documentsData?.filteredData?.length == 0"></app-nodata>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>


    <div class="border-dashed-blue m-b-20 m-t-30"></div>

    <!-- ===== actions ==== -->
    <div class="ondamand-actions m-t-30 m-b-30" fxLayout="row wrap">
        <div fxFlex="33.3" fxFlex.sm="33.3" fxFlex.xs="100" class="align-left">
            <button mat-stroked-button class="filled-lightgray huge-btn m-b-5" (click)="VMC1500Submit()">View CMS
                1500</button>

        </div>
        <div fxFlex="33.3" fxFlex.sm="33.3" fxFlex.xs="100" class="align-center">
            <!-- <button mat-stroked-button class="filled-success huge-btn m-b-5" (click)="billingOnDemand()">Bill On
                Demand</button> -->
            <button mat-stroked-button class="filled-success huge-btn m-b-5" (click)="openBillOnDemand()">Submit Bill
                and Report</button>


        </div>
        <div fxFlex="33.3" fxFlex.sm="33.3" fxFlex.xs="100" class="align-right">
            <button mat-stroked-button class="filled-secondary huge-btn" (click)="openDialog()">Post Payment</button>
        </div>

    </div>

    <div class="border-dashed-blue m-b-20 m-t-20"></div>

    <!-- ===== Billing Documents ==== -->
    <div class="completed-documents m-t-30">
        <mat-card>
            <mat-card-content>
                <div fxLayout="row wrap" class="w-100">
                    <div fxFlex="100">
                        <div class="main-title p-l-0">Billing Documents</div>
                        <p class="description p-l-0">This table lists the documents, actions that were performed on the
                            documents, the date
                            that the actions were performed and the document recipients.</p>
                    </div>
                    <div class="user-detail vertical-fixed default-cursor" fxFlex="100">
                        <table mat-table [dataSource]="dataSourceDocList" multiTemplateDataRows
                            class="mat-elevation-z8 user-table">
                            <ng-container matColumnDef="{{column}}"
                                *ngFor="let column of columnsToDisplayDoc; let i=index">
                                <th mat-header-cell *matHeaderCellDef>
                                    {{columnsNameDoc[i]}} </th>
                                <td mat-cell *matCellDef="let element">
                                    <span *ngIf="i == 0 && isMobile">
                                        <mat-icon mat-raised-button
                                            [ngClass]="{'table-expand': expandIdDoc == element.document_id, 'expand-close': !(expandIdDoc == element.document_id)}">
                                            {{ expandIdDoc == element.document_id ? 'remove_circle' : 'add_circle'}}
                                        </mat-icon>
                                    </span>
                                    <div *ngIf="element?.action != 'POST PAYMENT PAPER EOR'">
                                        <span *ngIf="column == 'doc_image'" class="file_type_icon"> 
                                            <mat-icon *ngIf="element?.payor_response_status == 'R'" class="text-danger">error</mat-icon>
                                        </span>
                                        <span *ngIf="column == 'file_name'">{{element?.file_name}}</span>
                                        <span *ngIf="column == 'action'" class="no-wrap-td"
                                            [ngSwitch]="element.action"><span *ngSwitchCase="'MD'">Downloaded</span>
                                            <span *ngSwitchCase="'MES'">E-Sign Downloaded</span>
                                            <span *ngSwitchCase="'SFTP'">Billed On Demand</span></span>
                                        <span *ngIf="column == 'date'"
                                            class="no-wrap-td">{{element?.date_of_request | date:'MM-dd-yyyy'}}</span>
                                        <span *ngIf="column == 'recipients'"><span
                                                *ngFor="let rec of element?.recipients;let last = last;">{{rec?.name}}
                                                {{!last ? ',' : ''}}</span></span>
                                        <span *ngIf="column == 'download' && element?.send">
                                            <a class="text-success"
                                                (click)="downloadDocumet(element?.send)">Download</a>
                                        </span>
                                        <span *ngIf="column == 'payor_response_message'">
                                           {{element?.payor_response_message?.length ? element?.payor_response_message[0]?._attributes?.MessageText :  element?.payor_response_message?._attributes?.MessageText}}
                                        </span>
                                    </div>
                                    <div *ngIf="element?.action == 'POST PAYMENT PAPER EOR'">
                                        <span *ngIf="column == 'doc_image'" class="file_type_icon"> 
                                            <!-- <img [src]="element?.file_name | fileType" alt=""> -->
                                            </span>
                                        <span *ngIf="column == 'file_name'">{{element?.file_name}}</span>
                                        <span *ngIf="column == 'action'" class="no-wrap-td">{{element?.action}}</span>
                                        <span *ngIf="column == 'date'"
                                            class="no-wrap-td">{{element?.date_of_request | date:'MM-dd-yyyy'}}</span>
                                        <span *ngIf="column == 'recipients'"></span>
                                        <span *ngIf="column == 'download'">
                                            <a class="text-success" (click)="downloadDocumet(element)">Download</a>
                                        </span>
                                        <span *ngIf="column == 'payor_response_message'">
                                        </span>
                                    </div>
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="expandedDetail">
                                <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplayDoc.length">
                                    <div class="detail"
                                        [@detailExpand]="expandIdDoc == element.document_id ? 'expanded' : 'collapsed'">
                                        <div class="responsive-table">
                                            <ng-container matColumnDef="doc_image">
                                <th mat-header-cell *matHeaderCellDef> </th>
                                <td mat-cell *matCellDef="let element" class="file_type_icon">
                                    <!-- <img [src]="element?.file_name | fileType" alt=""> -->
                                </td>
                            </ng-container>

                            <div class="no-wrap-td"><span>Action</span>
                                <span [ngSwitch]="element.action">
                                    <p *ngSwitchCase="'MD'" class="m-b-0">Downloaded</p>
                                    <p *ngSwitchCase="'MES'" class="m-b-0">E-Sign Downloaded</p>
                                    <p *ngSwitchCase="'SFTP'" class="m-b-0">Billed On Demand</p>
                                </span>
                            </div>
                            <div class="no-wrap-td"><span>Date</span><span>
                                    {{element?.date_of_request | date:'MM-dd-yyyy'}} </span></div>
                            <div><span>Recipients</span><span
                                    *ngFor="let rec of element?.recipients;let last = last;">{{rec?.name}}
                                    {{!last ? ',' : ''}}</span></div>
                            <div><span> Download Generated Items </span><span *ngIf="element?.send">
                                    <a class="text-success" (click)="downloadDocumet(element?.send)">Download</a>
                                </span></div>
                            <div><span>Further Information </span><span *ngIf="element?.payor_response_message">
                                {{element?.payor_response_message?.MessageText}}
                                </span></div>
                    </div>
                </div>
                </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="columnsToDisplayDoc;sticky :true"></tr>
                <tr mat-row *matRowDef="let element; columns: columnsToDisplayDoc;" class="row"
                    [class.row]="expandedElement === element" (click)="openElementDoc(element)">
                </tr>
                <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
                </table>
                <app-nodata *ngIf="dataSourceDocList?.filteredData?.length == 0"></app-nodata>
    </div>
</div>
</mat-card-content>
</mat-card>
</div>
</div>